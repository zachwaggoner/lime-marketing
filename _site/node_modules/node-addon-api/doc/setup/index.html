<h1>Setup</h1>
<h2>Prerequisites</h2>
<p>Before starting to use <strong>N-API</strong> you need to assure you have the following
prerequisites:</p>
<ul>
<li>
<p><strong>Node.JS</strong> see: <a href="https://nodejs.org/">Installing Node.js</a></p>
</li>
<li>
<p><strong>Node.js native addon build tool</strong></p>
<ul>
<li><strong><a href="node-gyp.md">node-gyp</a></strong></li>
</ul>
</li>
</ul>
<h2>Installation and usage</h2>
<p>To use <strong>N-API</strong> in a native module:</p>
<ol>
<li>Add a dependency on this package to <code>package.json</code>:</li>
</ol>
<pre><code class="language-json">  &quot;dependencies&quot;: {
    &quot;node-addon-api&quot;: &quot;*&quot;,
  }
</code></pre>
<ol start="2">
<li>Reference this package's include directory and gyp file in <code>binding.gyp</code>:</li>
</ol>
<pre><code class="language-gyp">  'include_dirs': [&quot;&lt;!(node -p \&quot;require('node-addon-api').include_dir\&quot;)&quot;],
</code></pre>
<ol start="3">
<li>Decide whether the package will enable C++ exceptions in the N-API wrapper.
The base ABI-stable C APIs do not throw or handle C++ exceptions, but the
N-API C++ wrapper classes may <em>optionally</em>
<a href="https://nodejs.github.io/node-addon-api/class_napi_1_1_error.html">integrate C++ and JavaScript exception-handling
</a>.
To enable that capability, C++ exceptions must be enabled in <code>binding.gyp</code>:</li>
</ol>
<pre><code class="language-gyp">  'cflags!': [ '-fno-exceptions' ],
  'cflags_cc!': [ '-fno-exceptions' ],
  'xcode_settings': {
    'GCC_ENABLE_CPP_EXCEPTIONS': 'YES',
    'CLANG_CXX_LIBRARY': 'libc++',
    'MACOSX_DEPLOYMENT_TARGET': '10.7',
  },
  'msvs_settings': {
    'VCCLCompilerTool': { 'ExceptionHandling': 1 },
  },
</code></pre>
<p>Alternatively, disable use of C++ exceptions in N-API:</p>
<pre><code class="language-gyp">  'defines': [ 'NAPI_DISABLE_CPP_EXCEPTIONS' ],
</code></pre>
<ol start="4">
<li>If you would like your native addon to support OSX, please also add the
following settings in the <code>binding.gyp</code> file:</li>
</ol>
<pre><code class="language-gyp">['OS==&quot;mac&quot;', {
    'cflags+': ['-fvisibility=hidden'],
    'xcode_settings': {
      'GCC_SYMBOLS_PRIVATE_EXTERN': 'YES', # -fvisibility=hidden
    }
}]
</code></pre>
<ol start="5">
<li>Include <code>napi.h</code> in the native module code.
To ensure only ABI-stable APIs are used, DO NOT include
<code>node.h</code>, <code>nan.h</code>, or <code>v8.h</code>.</li>
</ol>
<pre><code class="language-C++">#include &quot;napi.h&quot;
</code></pre>
<p>At build time, the N-API back-compat library code will be used only when the
targeted node version <em>does not</em> have N-API built-in.</p>
<p>The preprocessor directive <code>NODE_ADDON_API_DISABLE_DEPRECATED</code> can be defined at
compile time before including <code>napi.h</code> to skip the definition of deprecated APIs.</p>
