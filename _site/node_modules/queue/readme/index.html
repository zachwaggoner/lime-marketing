<pre><code>   ____  __  _____  __  _____
  / __ `/ / / / _ \/ / / / _ \
 / /_/ / /_/ /  __/ /_/ /  __/
 \__, /\__,_/\___/\__,_/\___/
   /_/
</code></pre>
<p>Asynchronous function queue with adjustable concurrency.</p>
<p><a href="http://www.npmjs.org/queue"><img src="http://img.shields.io/npm/v/queue.svg?style=flat-square" alt="npm"></a>
<a href="https://travis-ci.org/jessetane/queue"><img src="https://img.shields.io/travis/jessetane/queue.svg?style=flat-square&amp;branch=master" alt="tests"></a>
<a href="https://coveralls.io/r/jessetane/queue"><img src="https://img.shields.io/coveralls/jessetane/queue.svg?style=flat-square&amp;branch=master" alt="coverage"></a></p>
<p>This module exports a class <code>Queue</code> that implements most of the <code>Array</code> API. Pass async functions (ones that accept a callback or return a promise) to an instance's additive array methods. Processing begins when you call <code>q.start()</code>.</p>
<h2>Example</h2>
<p><code>npm run example</code></p>
<pre><code class="language-javascript">var queue = require('../')

var q = queue()
var results = []

// add jobs using the familiar Array API
q.push(function (cb) {
  results.push('two')
  cb()
})

q.push(
  function (cb) {
    results.push('four')
    cb()
  },
  function (cb) {
    results.push('five')
    cb()
  }
)

// jobs can accept a callback or return a promise
q.push(function () {
  return new Promise(function (resolve, reject) {
    results.push('one')
    resolve()
  })
})

q.unshift(function (cb) {
  results.push('one')
  cb()
})

q.splice(2, 0, function (cb) {
  results.push('three')
  cb()
})

// use the timeout feature to deal with jobs that
// take too long or forget to execute a callback
q.timeout = 100

q.on('timeout', function (next, job) {
  console.log('job timed out:', job.toString().replace(/\n/g, ''))
  next()
})

q.push(function (cb) {
  setTimeout(function () {
    console.log('slow job finished')
    cb()
  }, 200)
})

q.push(function (cb) {
  console.log('forgot to execute callback')
})

// jobs can also override the queue's timeout
// on a per-job basis
function extraSlowJob (cb) {
  setTimeout(function () {
    console.log('extra slow job finished')
    cb()
  }, 400)
}

extraSlowJob.timeout = 500
q.push(extraSlowJob)

// get notified when jobs complete
q.on('success', function (result, job) {
  console.log('job finished processing:', job.toString().replace(/\n/g, ''))
})

// begin processing, get notified on end / failure
q.start(function (err) {
  if (err) throw err
  console.log('all done:', results)
})
</code></pre>
<h2>Install</h2>
<p><code>npm install queue</code></p>
<p><em>Note</em>: You may need to install the <a href="https://github.com/Gozala/events"><code>events</code></a> dependency if
your environment does not have it by default (eg. browser, react-native).</p>
<h2>Test</h2>
<p><code>npm test</code>
<code>npm run test-browser</code></p>
<h2>API</h2>
<h3><code>var q = queue([opts])</code></h3>
<p>Constructor. <code>opts</code> may contain inital values for:</p>
<ul>
<li><code>q.concurrency</code></li>
<li><code>q.timeout</code></li>
<li><code>q.autostart</code></li>
<li><code>q.results</code></li>
</ul>
<h2>Instance methods</h2>
<h3><code>q.start([cb])</code></h3>
<p>cb, if passed, will be called when the queue empties or when an error occurs.</p>
<h3><code>q.stop()</code></h3>
<p>Stops the queue. can be resumed with <code>q.start()</code>.</p>
<h3><code>q.end([err])</code></h3>
<p>Stop and empty the queue immediately.</p>
<h2>Instance methods mixed in from <code>Array</code></h2>
<p>Mozilla has docs on how these methods work <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">here</a>. Note that <code>slice</code> does not copy the queue.</p>
<h3><code>q.push(element1, ..., elementN)</code></h3>
<h3><code>q.unshift(element1, ..., elementN)</code></h3>
<h3><code>q.splice(index , howMany[, element1[, ...[, elementN]]])</code></h3>
<h3><code>q.pop()</code></h3>
<h3><code>q.shift()</code></h3>
<h3><code>q.slice(begin[, end])</code></h3>
<h3><code>q.reverse()</code></h3>
<h3><code>q.indexOf(searchElement[, fromIndex])</code></h3>
<h3><code>q.lastIndexOf(searchElement[, fromIndex])</code></h3>
<h2>Properties</h2>
<h3><code>q.concurrency</code></h3>
<p>Max number of jobs the queue should process concurrently, defaults to <code>Infinity</code>.</p>
<h3><code>q.timeout</code></h3>
<p>Milliseconds to wait for a job to execute its callback. This can be overridden by specifying a <code>timeout</code> property on a per-job basis.</p>
<h3><code>q.autostart</code></h3>
<p>Ensures the queue is always running if jobs are available. Useful in situations where you are using a queue only for concurrency control.</p>
<h3><code>q.results</code></h3>
<p>An array to set job callback arguments on.</p>
<h3><code>q.length</code></h3>
<p>Jobs pending + jobs to process (readonly).</p>
<h2>Events</h2>
<h3><code>q.emit('start', job)</code></h3>
<p>Immediately before a job begins to execute.</p>
<h3><code>q.emit('success', result, job)</code></h3>
<p>After a job executes its callback.</p>
<h3><code>q.emit('error', err, job)</code></h3>
<p>After a job passes an error to its callback.</p>
<h3><code>q.emit('timeout', continue, job)</code></h3>
<p>After <code>q.timeout</code> milliseconds have elapsed and a job has not executed its callback.</p>
<h3><code>q.emit('end'[, err])</code></h3>
<p>After all jobs have been processed</p>
<h2>Releases</h2>
<p>The latest stable release is published to <a href="http://npmjs.org/queue">npm</a>. Abbreviated changelog below:</p>
<ul>
<li><a href="https://github.com/jessetane/queue/archive/6.0.1.tar.gz">6.0</a>
<ul>
<li>Add <code>start</code> event before job begins (@joelgriffith)</li>
<li>Add <code>timeout</code> property on a job to override the queue's timeout (@joelgriffith)</li>
</ul>
</li>
<li><a href="https://github.com/jessetane/queue/archive/5.0.0.tar.gz">5.0</a>
<ul>
<li>Updated TypeScript bindings (@Codex-)</li>
</ul>
</li>
<li><a href="https://github.com/jessetane/queue/archive/4.4.0.tar.gz">4.4</a>
<ul>
<li>Add results feature</li>
</ul>
</li>
<li><a href="https://github.com/jessetane/queue/archive/4.3.0.tar.gz">4.3</a>
<ul>
<li>Add promise support (@kwolfy)</li>
</ul>
</li>
<li><a href="https://github.com/jessetane/queue/archive/4.2.0.tar.gz">4.2</a>
<ul>
<li>Unref timers on end</li>
</ul>
</li>
<li><a href="https://github.com/jessetane/queue/archive/4.1.0.tar.gz">4.1</a>
<ul>
<li>Add autostart feature</li>
</ul>
</li>
<li><a href="https://github.com/jessetane/queue/archive/4.0.0.tar.gz">4.0</a>
<ul>
<li>Change license to MIT</li>
</ul>
</li>
<li><a href="https://github.com/jessetane/queue/archive/3.0.6.tar.gz">3.1.x</a>
<ul>
<li>Add .npmignore</li>
</ul>
</li>
<li><a href="https://github.com/jessetane/queue/archive/3.0.6.tar.gz">3.0.x</a>
<ul>
<li>Change the default concurrency to <code>Infinity</code></li>
<li>Allow <code>q.start()</code> to accept an optional callback executed on <code>q.emit('end')</code></li>
</ul>
</li>
<li><a href="https://github.com/jessetane/queue/archive/2.2.0.tar.gz">2.x</a>
<ul>
<li>Major api changes / not backwards compatible with 1.x</li>
</ul>
</li>
<li><a href="https://github.com/jessetane/queue/archive/1.0.2.tar.gz">1.x</a>
<ul>
<li>Early prototype</li>
</ul>
</li>
</ul>
<h2>License</h2>
<p>Copyright Â© 2014 Jesse Tane <a href="mailto:jesse.tane@gmail.com">jesse.tane@gmail.com</a></p>
<p>This work is free. You can redistribute it and/or modify it under the
terms of the <a href="https://opensource.org/licenses/MIT">MIT License</a>.
See LICENSE for full details.</p>
